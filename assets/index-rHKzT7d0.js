var t=Object.defineProperty,e=Object.defineProperties,s=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=(e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i,h=(t,e)=>{for(var s in e||(e={}))r.call(e,s)&&a(t,s,e[s]);if(i)for(var s of i(e))o.call(e,s)&&a(t,s,e[s]);return t},l=(t,e,s)=>a(t,"symbol"!=typeof e?e+"":e,s);!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class n{constructor(){l(this,"els",{score:document.getElementById("score"),time:document.getElementById("time"),armor:document.getElementById("armor"),powerFill:document.getElementById("powerFill"),hud:document.getElementById("hud"),speedControl:document.getElementById("speedControl"),zoomControl:document.getElementById("zoomControl"),startScreen:document.getElementById("startScreen"),gameOver:document.getElementById("gameOver"),finalScore:document.getElementById("finalScore"),survivalTime:document.getElementById("survivalTime"),asteroidsDestroyed:document.getElementById("asteroidsDestroyed"),gameResult:document.getElementById("gameResult"),speedSlider:document.getElementById("speedSlider"),zoomSlider:document.getElementById("zoomSlider"),speedValue:document.getElementById("speedValue"),zoomValue:document.getElementById("zoomValue"),startButton:document.getElementById("startButton"),restartButton:document.getElementById("restartButton"),zoomInBtn:document.getElementById("zoomInBtn"),zoomOutBtn:document.getElementById("zoomOutBtn"),zoomResetBtn:document.getElementById("zoomResetBtn"),levelObjectives:document.getElementById("levelObjectives")})}updateScore(t){this.els.score.textContent=t.toString()}updateTime(t){this.els.time.textContent=Math.ceil(t).toString()}updateArmor(t){this.els.armor.textContent=t.toString()}updatePower(t){this.els.powerFill.style.width=`${t}%`}showHud(t){this.els.hud.style.display=t?"block":"none",this.els.speedControl.style.display=t?"block":"none",this.els.zoomControl.style.display=t?"block":"none"}showStart(t){this.els.startScreen.style.display=t?"flex":"none"}showGameOver(t){this.els.gameOver.style.display=t?"flex":"none"}setGameResult(t,e,s){this.els.gameResult.textContent=t,this.els.gameResult.style.color=e,this.els.gameResult.style.textShadow=s}getSpeed(){return parseFloat(this.els.speedSlider.value)}setSpeedDisplay(t){this.els.speedValue.textContent=t.toFixed(1)+"x"}getZoom(){return parseFloat(this.els.zoomSlider.value)}setZoomDisplay(t){this.els.zoomValue.textContent=t.toFixed(1)+"x"}updateLevelInfo(t,e){const s=document.getElementById("levelInfo");s&&(s.innerHTML=`\n        <div style="font-weight: bold; color: #00ff88;">${t}</div>\n        <div style="font-size: 12px;">Progress: ${Math.round(e)}%</div>\n      `,s.style.display="block")}getElements(){return this.els}updateLevelObjectives(t){this.els.levelObjectives.innerHTML=t.map(t=>{if("survive"===t.type)return;const e=t.current>=t.target,s=Math.min(t.current/t.target*100,100);return`\n        <div class="objective ${e?"completed":""}" \n             data-type="${t.type}">\n          <div class="objective-icon">${this.getObjectiveIcon(t.type)}</div>\n          <div class="objective-info">\n            <div class="objective-text">${t.description}</div>\n            <div class="objective-progress">\n              <div class="progress-bar">\n                <div class="progress-fill" style="width: ${s}%"></div>\n              </div>\n              <span class="progress-text">${t.current}/${t.target}</span>\n            </div>\n          </div>\n          ${e?'<div class="objective-check">âœ“</div>':""}\n        </div>\n      `}).join("")}getObjectiveIcon(t){return{survive:"â±ï¸",collect:"â­",destroy:"ðŸ’¥",reach_score:"ðŸ†",boss:"ðŸ‘¾",power_star:"ðŸ”®"}[t]||"ðŸŽ¯"}showObjectiveCompleteEffect(t){const e=this.els.levelObjectives.querySelector(`[data-type="${t}"]`);e&&(e.classList.add("just-completed"),this.createCompletionParticles(e),setTimeout(()=>{e.classList.remove("just-completed")},2e3))}createCompletionParticles(t){}}class d{constructor(t,e,s){l(this,"x"),l(this,"y"),l(this,"radius"),this.x=t,this.y=e,this.radius=s}}class c extends d{constructor(t,e,s){super(t,e,s),l(this,"armor",3)}update(t){}render(t){t.save(),t.translate(this.x,this.y);const e=this.armor>0?"rgba(0, 255, 255, 0.6)":"rgba(255, 100, 100, 0.6)",s=t.createRadialGradient(0,0,0,0,0,2*this.radius);s.addColorStop(0,e),s.addColorStop(1,"rgba(0, 255, 255, 0)"),t.fillStyle=s,t.beginPath(),t.arc(0,0,2*this.radius,0,2*Math.PI),t.fill();const i=t.createRadialGradient(0,0,0,0,0,this.radius);i.addColorStop(0,"#00ffff"),i.addColorStop(1,"#0088ff"),t.fillStyle=i,t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI),t.fill(),t.strokeStyle="#ffffff",t.lineWidth=2,t.beginPath(),t.moveTo(0,.8*-this.radius),t.lineTo(0,.8*this.radius),t.stroke(),t.beginPath(),t.arc(0,0,.6*this.radius,0,2*Math.PI),t.stroke(),this.armor>0&&(t.strokeStyle="#00ff88",t.lineWidth=3,t.beginPath(),t.arc(0,0,1.2*this.radius,-Math.PI/2,-Math.PI/2+2*Math.PI*(this.armor/5)),t.stroke()),t.restore()}}class u extends d{constructor(t,e,s){super(t,e,s),l(this,"type","star"),l(this,"rotation",0),l(this,"rotationSpeed"),l(this,"pulse",0),l(this,"pulseSpeed"),l(this,"time",0),this.rotationSpeed=.1*(Math.random()-.5),this.pulseSpeed=.05*Math.random()+.02}update(t){this.rotation+=this.rotationSpeed*t,this.time+=.05*t,this.pulse=.5*Math.sin(this.time)+.5}render(t){const e=this.radius*(.8+.4*this.pulse),s=t.createRadialGradient(this.x,this.y,0,this.x,this.y,2*e);s.addColorStop(0,"rgba(255, 255, 0, 0.8)"),s.addColorStop(1,"rgba(255, 255, 0, 0)"),t.fillStyle=s,t.beginPath(),t.arc(this.x,this.y,2*e,0,2*Math.PI),t.fill(),t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.strokeStyle="#ffffff",t.lineWidth=2,t.beginPath();for(let i=0;i<5;i++){const s=i*Math.PI*2/5-Math.PI/2,r=Math.cos(s)*e,o=Math.sin(s)*e;0===i?t.moveTo(r,o):t.lineTo(r,o);const a=s+Math.PI/5,h=Math.cos(a)*e*.5,l=Math.sin(a)*e*.5;t.lineTo(h,l)}t.closePath(),t.fillStyle="#ffff00",t.fill(),t.stroke(),t.restore()}}class p extends d{constructor(t,e,s){super(t,e,s),l(this,"type","powerStar"),l(this,"rotation",0),l(this,"rotationSpeed"),l(this,"pulse",0),l(this,"pulseSpeed"),l(this,"time",0),this.rotationSpeed=.15*(Math.random()-.5),this.pulseSpeed=.08*Math.random()+.04}update(t){this.rotation+=this.rotationSpeed*t,this.time+=.08*t,this.pulse=.7*Math.sin(this.time)+.3}render(t){const e=this.radius*(.8+.4*this.pulse),s=t.createRadialGradient(this.x,this.y,0,this.x,this.y,2.5*e);s.addColorStop(0,"rgba(255, 102, 255, 0.9)"),s.addColorStop(1,"rgba(255, 102, 255, 0)"),t.fillStyle=s,t.beginPath(),t.arc(this.x,this.y,2.5*e,0,2*Math.PI),t.fill(),t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.strokeStyle="#ffffff",t.lineWidth=2,t.beginPath();for(let i=0;i<6;i++){const s=i*Math.PI*2/6,r=Math.cos(s)*e,o=Math.sin(s)*e;0===i?t.moveTo(r,o):t.lineTo(r,o)}t.closePath(),t.fillStyle="#ff66ff",t.fill(),t.stroke(),t.restore()}}class m extends d{constructor(t,e,s,i,r){super(t,e,s),l(this,"vx"),l(this,"vy"),l(this,"rotation",0),l(this,"rotationSpeed"),l(this,"health",1),this.vx=i,this.vy=r,this.rotationSpeed=.08*(Math.random()-.5)}update(t,e,s){this.x+=this.vx*t,this.y+=this.vy*t,this.rotation+=this.rotationSpeed*t;const i=e||800,r=s||600;(this.x-this.radius<=0||this.x+this.radius>=i)&&(this.vx=-this.vx,this.x=Math.max(this.radius,Math.min(i-this.radius,this.x))),(this.y-this.radius<=0||this.y+this.radius>=r)&&(this.vy=-this.vy,this.y=Math.max(this.radius,Math.min(r-this.radius,this.y)))}render(t){t.save(),t.translate(this.x,this.y),t.rotate(this.rotation);const e=t.createRadialGradient(0,0,0,0,0,1.5*this.radius);e.addColorStop(0,"rgba(255, 68, 68, 0.4)"),e.addColorStop(1,"rgba(255, 68, 68, 0)"),t.fillStyle=e,t.beginPath(),t.arc(0,0,1.5*this.radius,0,2*Math.PI),t.fill(),t.fillStyle="#ff4444",t.strokeStyle="#ff8888",t.lineWidth=2,t.beginPath();for(let s=0;s<8;s++){const e=s*Math.PI*2/8,i=this.radius*(.7+.3*Math.sin(.001*Date.now()+s)),r=Math.cos(e)*i,o=Math.sin(e)*i;0===s?t.moveTo(r,o):t.lineTo(r,o)}t.closePath(),t.fill(),t.stroke(),t.restore()}}class v extends d{constructor(t,e,s,i){super(t,e,s),l(this,"maxRadius"),l(this,"color"),l(this,"life"),l(this,"maxLife"),this.maxRadius=3*s,this.color=i,this.life=30,this.maxLife=30}update(t){this.life--,this.radius+=.1*(this.maxRadius-this.radius)}render(t){if(this.life<=0)return;const e=this.life/this.maxLife,s=t.createRadialGradient(this.x,this.y,0,this.x,this.y,this.radius);s.addColorStop(0,`rgba(255, 102, 255, ${.8*e})`),s.addColorStop(1,"rgba(255, 102, 255, 0)"),t.fillStyle=s,t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fill()}}class g extends d{constructor(t,e,s,i,r,o){super(t,e,r),l(this,"vx"),l(this,"vy"),l(this,"life"),l(this,"color"),this.vx=s,this.vy=i,this.life=40,this.color=o}update(t){this.x+=this.vx*t,this.y+=this.vy*t,this.life--,this.vy+=.1*t}render(t){this.life<=0||(t.globalAlpha=this.life/40,t.fillStyle=this.color,t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fill(),t.globalAlpha=1)}}class y{constructor(t,e){l(this,"worldWidth",800),l(this,"worldHeight",600),l(this,"baseWidth",800),l(this,"baseHeight",600),l(this,"scale",1),l(this,"targetScale",1),l(this,"canvas"),l(this,"ctx"),this.canvas=t,this.ctx=e}setScale(t){this.targetScale=Math.max(.5,Math.min(3,t))}restoreTransform(){this.ctx.restore()}update(){this.scale+=.1*(this.targetScale-this.scale),this.worldWidth=this.baseWidth*this.scale,this.worldHeight=this.baseHeight*this.scale}applyWorldTransform(){this.ctx.save();const t=this.canvas.width/this.worldWidth,e=this.canvas.height/this.worldHeight,s=Math.min(t,e);this.ctx.scale(s,s);const i=(this.canvas.width/s-this.worldWidth)/2,r=(this.canvas.height/s-this.worldHeight)/2;this.ctx.translate(i,r)}screenToWorld(t,e){const s=this.canvas.width/this.worldWidth,i=this.canvas.height/this.worldHeight,r=Math.min(s,i);return{x:t/r-(this.canvas.width/r-this.worldWidth)/2,y:e/r-(this.canvas.height/r-this.worldHeight)/2}}getVisibleArea(){const t=this.canvas.width/this.worldWidth,e=this.canvas.height/this.worldHeight,s=Math.min(t,e),i=this.canvas.width/s,r=this.canvas.height/s;return{x:(this.worldWidth-i)/2,y:(this.worldHeight-r)/2,width:i,height:r}}isInWorld(t,e){return t>=0&&t<=this.worldWidth&&e>=0&&e<=this.worldHeight}getSpawnArea(){return{width:this.worldWidth,height:this.worldHeight}}reset(){this.scale=1,this.targetScale=1,this.worldWidth=this.baseWidth,this.worldHeight=this.baseHeight}}const S={1:{id:1,name:"ÐšÐ¾ÑÐ¼Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð´ÐµÐ±ÑŽÑ‚",description:"ÐžÑÐ²Ð¾Ð¹Ñ‚ÐµÑÑŒ Ð² ÐºÐ¾ÑÐ¼Ð¾ÑÐµ",background:"deep_space",gameSpeed:1,worldScale:1,duration:25,difficulty:"easy",objectives:[{type:"survive",target:25,description:"Ð’Ñ‹Ð¶Ð¸Ñ‚ÑŒ 25 ÑÐµÐºÑƒÐ½Ð´",current:0},{type:"collect",target:8,description:"Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ 8 Ð·Ð²ÐµÐ·Ð´",current:0}],spawnSettings:{stars:6,powerStars:1,asteroids:4}},2:{id:2,name:"ÐŸÐµÑ€Ð²Ñ‹Ðµ Ð°ÑÑ‚ÐµÑ€Ð¾Ð¸Ð´Ñ‹",description:"ÐÐ°ÑƒÑ‡Ð¸Ñ‚ÐµÑÑŒ Ð¸Ð·Ð±ÐµÐ³Ð°Ñ‚ÑŒ Ð¿Ñ€ÐµÐ¿ÑÑ‚ÑÑ‚Ð²Ð¸Ñ",background:"deep_space",gameSpeed:1.1,worldScale:1.1,duration:30,difficulty:"easy",objectives:[{type:"survive",target:30,description:"Ð’Ñ‹Ð¶Ð¸Ñ‚ÑŒ 30 ÑÐµÐºÑƒÐ½Ð´",current:0},{type:"collect",target:12,description:"Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ 12 Ð·Ð²ÐµÐ·Ð´",current:0},{type:"destroy",target:5,description:"Ð£Ð½Ð¸Ñ‡Ñ‚Ð¾Ð¶Ð¸Ñ‚ÑŒ 5 Ð°ÑÑ‚ÐµÑ€Ð¾Ð¸Ð´Ð¾Ð²",current:0}],spawnSettings:{stars:8,powerStars:2,asteroids:6}},3:{id:3,name:"Ð—Ð²ÐµÐ·Ð´Ð½Ñ‹Ð¹ ÑÐ±Ð¾Ñ€Ñ‰Ð¸Ðº",description:"Ð¡Ð¾Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÐºÐ°Ðº Ð¼Ð¾Ð¶Ð½Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð·Ð²ÐµÐ·Ð´",background:"nebula",gameSpeed:1,worldScale:1.2,duration:35,difficulty:"easy",objectives:[{type:"collect",target:20,description:"Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ 20 Ð·Ð²ÐµÐ·Ð´",current:0},{type:"reach_score",target:300,description:"ÐÐ°Ð±Ñ€Ð°Ñ‚ÑŒ 300 Ð¾Ñ‡ÐºÐ¾Ð²",current:0}],spawnSettings:{stars:10,powerStars:2,asteroids:5}},4:{id:4,name:"Ð Ð°ÑÑˆÐ¸Ñ€ÑÑŽÑ‰Ð°ÑÑÑ Ð²ÑÐµÐ»ÐµÐ½Ð½Ð°Ñ",description:"ÐœÐ¸Ñ€ ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑÑ Ð±Ð¾Ð»ÑŒÑˆÐµ",background:"deep_space",gameSpeed:1,worldScale:1.5,duration:40,difficulty:"easy",objectives:[{type:"survive",target:40,description:"Ð’Ñ‹Ð¶Ð¸Ñ‚ÑŒ 40 ÑÐµÐºÑƒÐ½Ð´",current:0},{type:"collect",target:15,description:"Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ 15 Ð·Ð²ÐµÐ·Ð´",current:0}],spawnSettings:{stars:9,powerStars:2,asteroids:7}},5:{id:5,name:"Ð¢Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ° Ñ POWER",description:"ÐžÑÐ²Ð¾Ð¹Ñ‚Ðµ Ð²Ð·Ñ€Ñ‹Ð²Ð½ÑƒÑŽ Ð²Ð¾Ð»Ð½Ñƒ",background:"nebula",gameSpeed:1.1,worldScale:1.3,duration:35,difficulty:"easy",objectives:[{type:"destroy",target:10,description:"Ð£Ð½Ð¸Ñ‡Ñ‚Ð¾Ð¶Ð¸Ñ‚ÑŒ 10 Ð°ÑÑ‚ÐµÑ€Ð¾Ð¸Ð´Ð¾Ð²",current:0},{type:"collect",target:18,description:"Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ 18 Ð·Ð²ÐµÐ·Ð´",current:0}],spawnSettings:{stars:8,powerStars:3,asteroids:8}},6:{id:6,name:"Ð¡ÐºÐ¾Ñ€Ð¾ÑÑ‚Ð½Ð¾Ð¹ Ð¿Ð¾Ð»ÐµÑ‚",description:"ÐÑÑ‚ÐµÑ€Ð¾Ð¸Ð´Ñ‹ Ð½Ð°Ñ‡Ð¸Ð½Ð°ÑŽÑ‚ Ð´Ð²Ð¸Ð³Ð°Ñ‚ÑŒÑÑ Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ",background:"deep_space",gameSpeed:1.3,worldScale:1.2,duration:30,difficulty:"easy",objectives:[{type:"survive",target:30,description:"Ð’Ñ‹Ð¶Ð¸Ñ‚ÑŒ 30 ÑÐµÐºÑƒÐ½Ð´",current:0},{type:"reach_score",target:400,description:"ÐÐ°Ð±Ñ€Ð°Ñ‚ÑŒ 400 Ð¾Ñ‡ÐºÐ¾Ð²",current:0}],spawnSettings:{stars:7,powerStars:2,asteroids:9}},7:{id:7,name:"ÐšÐ¾Ð¼Ð±Ð¸Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ Ð·Ð°Ð´Ð°Ñ‡Ð°",description:"ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð²ÑÐµ Ð½Ð°Ð²Ñ‹ÐºÐ¸",background:"nebula",gameSpeed:1.2,worldScale:1.4,duration:45,difficulty:"easy",objectives:[{type:"survive",target:45,description:"Ð’Ñ‹Ð¶Ð¸Ñ‚ÑŒ 45 ÑÐµÐºÑƒÐ½Ð´",current:0},{type:"collect",target:25,description:"Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ 25 Ð·Ð²ÐµÐ·Ð´",current:0},{type:"destroy",target:12,description:"Ð£Ð½Ð¸Ñ‡Ñ‚Ð¾Ð¶Ð¸Ñ‚ÑŒ 12 Ð°ÑÑ‚ÐµÑ€Ð¾Ð¸Ð´Ð¾Ð²",current:0}],spawnSettings:{stars:11,powerStars:3,asteroids:10}},8:{id:8,name:"ÐÑÑ‚ÐµÑ€Ð¾Ð¸Ð´Ð½Ñ‹Ð¹ ÑˆÑ‚Ð¾Ñ€Ð¼",description:"Ð˜Ð½Ñ‚ÐµÐ½ÑÐ¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð°ÐµÑ‚",background:"asteroid_field",gameSpeed:1.4,worldScale:1.6,duration:50,difficulty:"medium",objectives:[{type:"survive",target:50,description:"Ð’Ñ‹Ð¶Ð¸Ñ‚ÑŒ 50 ÑÐµÐºÑƒÐ½Ð´",current:0},{type:"collect",target:30,description:"Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ 30 Ð·Ð²ÐµÐ·Ð´",current:0},{type:"destroy",target:18,description:"Ð£Ð½Ð¸Ñ‡Ñ‚Ð¾Ð¶Ð¸Ñ‚ÑŒ 18 Ð°ÑÑ‚ÐµÑ€Ð¾Ð¸Ð´Ð¾Ð²",current:0}],spawnSettings:{stars:12,powerStars:3,asteroids:14}},9:{id:9,name:"ÐšÐ¾ÑÐ¼Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¼Ð°Ñ€Ð°Ñ„Ð¾Ð½",description:"Ð’Ñ‹Ð½Ð¾ÑÐ»Ð¸Ð²Ð¾ÑÑ‚ÑŒ Ð¸ ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ",background:"asteroid_field",gameSpeed:1.5,worldScale:1.8,duration:60,difficulty:"medium",objectives:[{type:"survive",target:60,description:"Ð’Ñ‹Ð¶Ð¸Ñ‚ÑŒ 60 ÑÐµÐºÑƒÐ½Ð´",current:0},{type:"reach_score",target:800,description:"ÐÐ°Ð±Ñ€Ð°Ñ‚ÑŒ 800 Ð¾Ñ‡ÐºÐ¾Ð²",current:0},{type:"collect",target:35,description:"Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ 35 Ð·Ð²ÐµÐ·Ð´",current:0}],spawnSettings:{stars:13,powerStars:4,asteroids:16}},10:{id:10,name:"Ð—Ð²ÐµÐ·Ð´Ð½Ñ‹Ð¹ Ð¾Ñ…Ð¾Ñ‚Ð½Ð¸Ðº",description:"Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¸ÑÐ¿Ñ‹Ñ‚Ð°Ð½Ð¸Ðµ",background:"nebula",gameSpeed:1.6,worldScale:2,duration:75,difficulty:"hard",objectives:[{type:"reach_score",target:1200,description:"ÐÐ°Ð±Ñ€Ð°Ñ‚ÑŒ 1200 Ð¾Ñ‡ÐºÐ¾Ð²",current:0},{type:"collect",target:40,description:"Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ 40 Ð·Ð²ÐµÐ·Ð´",current:0},{type:"destroy",target:25,description:"Ð£Ð½Ð¸Ñ‡Ñ‚Ð¾Ð¶Ð¸Ñ‚ÑŒ 25 Ð°ÑÑ‚ÐµÑ€Ð¾Ð¸Ð´Ð¾Ð²",current:0}],spawnSettings:{stars:15,powerStars:4,asteroids:18}}};class f{constructor(){l(this,"currentLevelId",1),l(this,"currentLevel"),l(this,"objectivesProgress",new Map),l(this,"levelStats",{starsCollected:0,asteroidsDestroyed:0,powerStarsCollected:0,score:0,timeSurvived:0}),this.currentLevel=S[this.currentLevelId],this.initializeObjectives()}initializeObjectives(){this.levelStats={starsCollected:0,asteroidsDestroyed:0,powerStarsCollected:0,score:0,timeSurvived:0},this.currentLevel.objectives.forEach(t=>{this.objectivesProgress.set(this.getObjectiveKey(t),0)})}getObjectiveKey(t){return`${t.type}_${t.target}`}loadLevel(t){if(!S[t])throw new Error(`Level ${t} not found`);return this.currentLevelId=t,this.currentLevel=h({},S[t]),this.currentLevel.objectives=this.currentLevel.objectives.map(t=>{return i=h({},t),e(i,s({current:0}));var i}),this.initializeObjectives(),this.currentLevel}getCurrentLevel(){return this.currentLevel}updateObjectiveProgress(t,e){switch(t){case"star_collected":this.levelStats.starsCollected+=e;break;case"asteroid_destroyed":this.levelStats.asteroidsDestroyed+=e;break;case"power_star_collected":this.levelStats.powerStarsCollected+=e;break;case"score":this.levelStats.score+=e;break;case"time":this.levelStats.timeSurvived+=e}this.updateObjectives()}updateObjectives(){this.currentLevel.objectives.forEach(t=>{let e=0;switch(t.type){case"survive":e=this.levelStats.timeSurvived;break;case"collect":e=this.levelStats.starsCollected;break;case"destroy":e=this.levelStats.asteroidsDestroyed;break;case"reach_score":e=this.levelStats.score}t.current=Math.min(e,t.target)})}checkLevelCompletion(){return{completed:this.currentLevel.objectives.every(t=>t.current>=t.target),objectives:this.currentLevel.objectives}}getLevelProgress(){const t=this.currentLevel.objectives.reduce((t,e)=>t+e.target,0),e=this.currentLevel.objectives.reduce((t,e)=>t+e.current,0);return t>0?e/t*100:0}getLevelStats(){return h({},this.levelStats)}hasNextLevel(){return!!S[this.currentLevelId+1]}getNextLevel(){return S[this.currentLevelId+1]||null}}class w{constructor(){l(this,"canvas",document.getElementById("gameCanvas")),l(this,"ctx",this.canvas.getContext("2d")),l(this,"ui",new n),l(this,"player"),l(this,"world"),l(this,"levelSystem"),l(this,"stars",[]),l(this,"powerStars",[]),l(this,"asteroids",[]),l(this,"particles",[]),l(this,"explosions",[]),l(this,"score",0),l(this,"gameTime",60),l(this,"power",0),l(this,"gameRunning",!1),l(this,"gameWon",!1),l(this,"animationId",null),l(this,"gameSpeed",1),l(this,"asteroidSpeed",1),l(this,"levelAsteroidSpeed",1),l(this,"asteroidsDestroyed",0),l(this,"mouseX",400),l(this,"mouseY",300),l(this,"currentZoomLevel",1),l(this,"gameLoop",()=>{this.update(),this.render(),this.animationId=requestAnimationFrame(this.gameLoop)}),this.player=new c(400,300,20),this.world=new y(this.canvas,this.ctx),this.levelSystem=new f,this.initEventListeners(),this.setupZoomControls(),this.ui.showStart(!0)}setupZoomControls(){const t=this.ui.getElements();t.zoomSlider&&t.zoomSlider.addEventListener("input",t=>{const e=t.target,s=parseFloat(e.value);this.setWorldZoom(s),this.ui.setZoomDisplay(s)}),t.zoomInBtn&&t.zoomInBtn.addEventListener("click",()=>{this.setWorldZoom(this.currentZoomLevel+.5)}),t.zoomOutBtn&&t.zoomOutBtn.addEventListener("click",()=>{this.setWorldZoom(this.currentZoomLevel-.5)}),t.zoomResetBtn&&t.zoomResetBtn.addEventListener("click",()=>{this.resetWorldZoom()})}setWorldZoom(t){this.currentZoomLevel=Math.max(.5,Math.min(3,t)),this.world.setScale(this.currentZoomLevel),this.ui.setZoomDisplay&&this.ui.setZoomDisplay(this.currentZoomLevel)}resetWorldZoom(){this.currentZoomLevel=1,this.world.setScale(1);const t=this.ui.getElements();t.zoomSlider&&(t.zoomSlider.value="1.0"),this.ui.setZoomDisplay&&this.ui.setZoomDisplay(1)}initEventListeners(){this.ui.getElements().startButton.addEventListener("click",()=>this.startNewGame()),this.ui.getElements().restartButton.addEventListener("click",()=>{this.animationId&&cancelAnimationFrame(this.animationId),this.restartCurrentLevel()}),this.ui.getElements().speedSlider.addEventListener("input",()=>{this.gameSpeed=this.ui.getSpeed(),this.ui.setSpeedDisplay(this.gameSpeed)}),this.canvas.addEventListener("mousemove",t=>{const e=this.canvas.getBoundingClientRect();this.mouseX=t.clientX-e.left,this.mouseY=t.clientY-e.top;const s=this.world.screenToWorld(this.mouseX,this.mouseY);this.player.x=Math.max(this.player.radius,Math.min(this.world.worldWidth-this.player.radius,s.x)),this.player.y=Math.max(this.player.radius,Math.min(this.world.worldHeight-this.player.radius,s.y))}),this.canvas.addEventListener("wheel",t=>{t.preventDefault();const e=t.deltaY>0?-.2:.2;this.setWorldZoom(this.currentZoomLevel+e)}),document.addEventListener("keydown",t=>{"Space"===t.code&&this.gameRunning&&this.explodeAllObjects(),"Equal"!==t.code&&"NumpadAdd"!==t.code||(t.preventDefault(),this.setWorldZoom(this.currentZoomLevel+.5)),"Minus"!==t.code&&"NumpadSubtract"!==t.code||(t.preventDefault(),this.setWorldZoom(this.currentZoomLevel-.5)),"Digit0"===t.code&&this.resetWorldZoom()}),this.canvas.addEventListener("touchmove",t=>{t.preventDefault();const e=this.canvas.getBoundingClientRect();this.mouseX=t.touches[0].clientX-e.left,this.mouseY=t.touches[0].clientY-e.top;const s=this.world.screenToWorld(this.mouseX,this.mouseY);this.player.x=Math.max(this.player.radius,Math.min(this.world.worldWidth-this.player.radius,s.x)),this.player.y=Math.max(this.player.radius,Math.min(this.world.worldHeight-this.player.radius,s.y))})}init(){const t=this.levelSystem.getCurrentLevel();this.score=0,this.gameTime=t.duration,this.player.armor=3,this.power=0,this.asteroidsDestroyed=0,this.gameWon=!1,this.resetWorldZoom(),this.world.reset(),this.world.setScale(t.worldScale),this.gameSpeed=1,this.levelAsteroidSpeed=t.gameSpeed,this.asteroidSpeed=this.levelAsteroidSpeed,this.ui.setSpeedDisplay(this.gameSpeed),this.player.x=this.world.worldWidth/2,this.player.y=this.world.worldHeight/2,this.updateUI(),this.updateLevelUI(),this.stars=[],this.powerStars=[],this.asteroids=[],this.particles=[],this.explosions=[],this.spawnLevelObjects()}spawnLevelObjects(){const t=this.levelSystem.getCurrentLevel().spawnSettings;for(let e=0;e<t.stars;e++)this.createStar();for(let e=0;e<t.powerStars;e++)this.createPowerStar();for(let e=0;e<t.asteroids;e++)this.createBouncingAsteroid()}createStar(){const t=this.world.getSpawnArea(),e=Math.random()*(t.width-200)+100,s=Math.random()*(t.height-200)+100,i=8*Math.random()+4;this.stars.push(new u(e,s,i))}createPowerStar(){const t=this.world.getSpawnArea(),e=Math.random()*(t.width-200)+100,s=Math.random()*(t.height-200)+100,i=10*Math.random()+6;this.powerStars.push(new p(e,s,i))}createBouncingAsteroid(){const t=this.world.getSpawnArea(),e=25*Math.random()+15,s=Math.random()*(t.width-4*e)+2*e,i=Math.random()*(t.height-4*e)+2*e,r=(2*Math.random()+1)*this.levelAsteroidSpeed,o=Math.random()*Math.PI*2;this.asteroids.push(new m(s,i,e,Math.cos(o)*r,Math.sin(o)*r))}createParticles(t,e,s,i=10){for(let r=0;r<i;r++){const i=8*(Math.random()-.5),r=8*(Math.random()-.5),o=4*Math.random()+1;this.particles.push(new g(t,e,i,r,o,s))}}createExplosion(t,e,s,i){this.explosions.push(new v(t,e,s,i)),this.createParticles(t,e,i,30)}createExplosionWave(t,e,s,i){const r=30+.5*s,o=2+Math.floor(s/50),a=20+.3*s;for(let h=0;h<o;h++)setTimeout(()=>{const o=r+h*a;if(this.createExplosion(t,e,o,i),s>50&&h>0){const r=4+Math.floor(s/25),a=2*Math.PI/r;for(let s=0;s<r;s++){const r=s*a,h=.6*o,l=Math.cos(r)*h,n=Math.sin(r)*h;this.createExplosion(t+l,e+n,.3*o,i)}}},150*h)}explodeAllObjects(){const t=this.power;this.power=0,this.ui.updatePower(0),this.createExplosionWave(this.player.x,this.player.y,t,"#ff66ff"),this.destroyObjectsInRadius(this.player.x,this.player.y,t);setTimeout(()=>{this.spawnLevelObjects(),this.updateUI()},600+2*t)}destroyObjectsInRadius(t,e,s){const i=100+3*s,r=[];this.asteroids.forEach(s=>{const o=s.x-t,a=s.y-e;Math.sqrt(o*o+a*a)<=i&&(r.push(s),this.createExplosion(s.x,s.y,15,"#ff6666"))}),this.asteroidsDestroyed+=r.length,this.levelSystem.updateObjectiveProgress("asteroid_destroyed",r.length),this.asteroids=this.asteroids.filter(t=>!r.includes(t));let o=0,a=0;this.stars.forEach(s=>{const r=s.x-t,a=s.y-e;Math.sqrt(r*r+a*a)<=i&&(o++,this.createParticles(s.x,s.y,"#ffffff",8))}),this.powerStars.forEach(s=>{const r=s.x-t,o=s.y-e;Math.sqrt(r*r+o*o)<=i&&(a++,this.createParticles(s.x,s.y,"#ff66ff",12))});const h=15*o,l=25*a;this.score+=h+l,this.levelSystem.updateObjectiveProgress("star_collected",o),this.levelSystem.updateObjectiveProgress("power_star_collected",a),this.levelSystem.updateObjectiveProgress("score",h+l),this.stars=this.stars.filter(s=>{const r=s.x-t,o=s.y-e;return Math.sqrt(r*r+o*o)>i}),this.powerStars=this.powerStars.filter(s=>{const r=s.x-t,o=s.y-e;return Math.sqrt(r*r+o*o)>i})}updateUI(){this.ui.updateScore(this.score),this.ui.updateTime(this.gameTime),this.ui.updateArmor(this.player.armor),this.ui.updatePower(this.power)}updateLevelUI(){const t=this.levelSystem.getCurrentLevel(),e=this.levelSystem.getLevelProgress();this.ui.updateLevelObjectives(t.objectives),this.ui.updateLevelInfo(t.name,e)}checkCollisions(){for(let t=this.stars.length-1;t>=0;t--){const e=this.stars[t],s=e.x-this.player.x,i=e.y-this.player.y;Math.sqrt(s*s+i*i)<this.player.radius+e.radius&&(this.stars.splice(t,1),this.score+=10,this.levelSystem.updateObjectiveProgress("star_collected",1),this.levelSystem.updateObjectiveProgress("score",10),this.createParticles(e.x,e.y,"#ffff00",15),this.createStar(),this.updateUI(),this.updateLevelUI())}for(let t=this.powerStars.length-1;t>=0;t--){const e=this.powerStars[t],s=e.x-this.player.x,i=e.y-this.player.y;Math.sqrt(s*s+i*i)<this.player.radius+e.radius&&(this.powerStars.splice(t,1),this.player.armor++,this.power=Math.min(100,this.power+30),this.score+=25,this.levelSystem.updateObjectiveProgress("power_star_collected",1),this.levelSystem.updateObjectiveProgress("score",25),this.createParticles(e.x,e.y,"#ff66ff",25),this.createPowerStar(),this.updateUI(),this.updateLevelUI())}for(let t=this.asteroids.length-1;t>=0;t--){const e=this.asteroids[t],s=e.x-this.player.x,i=e.y-this.player.y;if(Math.sqrt(s*s+i*i)<this.player.radius+e.radius){if(!(this.player.armor>0))return void this.gameOver();this.player.armor--,this.asteroids.splice(t,1),this.asteroidsDestroyed++,this.levelSystem.updateObjectiveProgress("asteroid_destroyed",1),this.createParticles(e.x,e.y,"#ff4444",20),this.createBouncingAsteroid(),this.updateUI(),this.updateLevelUI()}}}update(){if(!this.gameRunning)return;if(this.world.update(),this.gameTime>0&&!this.gameWon&&(this.gameTime-=1/60,this.levelSystem.updateObjectiveProgress("time",1/60),this.ui.updateTime(this.gameTime),this.gameTime<=0))return void this.checkLevelCompletion();this.power<100&&(this.power+=.5,this.ui.updatePower(this.power));const t={width:this.world.worldWidth,height:this.world.worldHeight};this.stars.forEach(t=>t.update(1)),this.powerStars.forEach(t=>t.update(1)),this.asteroidSpeed=this.levelAsteroidSpeed*this.gameSpeed,this.asteroids.forEach(e=>{e.update(this.asteroidSpeed,t.width,t.height)}),this.explosions.forEach(t=>t.update(1)),this.particles.forEach(t=>t.update(1)),this.explosions=this.explosions.filter(t=>t.life>0),this.particles=this.particles.filter(t=>t.life>0),this.checkCollisions()}render(){this.ctx.fillStyle="#0a0a1a",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.world.applyWorldTransform(),this.ctx.fillStyle="rgba(255,255,255,0.2)";const t=150*this.currentZoomLevel;for(let e=0;e<t;e++){const t=41*e%this.world.worldWidth,s=67*e%this.world.worldHeight,i=.3*Math.sin(.001*Date.now()+e)+1;this.ctx.beginPath(),this.ctx.arc(t,s,i,0,2*Math.PI),this.ctx.fill()}this.explosions.forEach(t=>t.render(this.ctx)),this.stars.forEach(t=>t.render(this.ctx)),this.powerStars.forEach(t=>t.render(this.ctx)),this.asteroids.forEach(t=>t.render(this.ctx)),this.player.render(this.ctx),this.particles.forEach(t=>t.render(this.ctx)),this.world.restoreTransform()}checkLevelCompletion(){this.levelSystem.checkLevelCompletion().completed?this.completeLevel():this.failLevel()}startNewGame(){this.gameRunning&&this.animationId&&cancelAnimationFrame(this.animationId),this.ui.showStart(!1),this.ui.showHud(!0),this.gameRunning=!0,this.levelSystem?this.levelSystem.loadLevel(1):this.levelSystem=new f,this.init(),this.gameLoop()}startNextLevel(){const t=this.levelSystem.getCurrentLevel().id+1;this.levelSystem.loadLevel(t),this.startLevel(t)}restartCurrentLevel(){const t=this.levelSystem.getCurrentLevel().id;this.levelSystem.loadLevel(t),this.startLevel(t)}startLevel(t){this.gameRunning=!1,this.animationId&&cancelAnimationFrame(this.animationId),this.ui.showGameOver(!1),this.ui.showHud(!0),this.gameRunning=!0,this.init(),this.gameLoop()}failLevel(){this.gameOver()}completeLevel(){this.gameRunning=!1,this.animationId&&cancelAnimationFrame(this.animationId);this.levelSystem.checkLevelCompletion().completed?this.levelSystem.hasNextLevel()?this.showLevelCompleteScreen():this.showGameCompleteScreen():this.showLevelFailedScreen()}showLevelCompleteScreen(){const t=this.levelSystem.getCurrentLevel(),e=this.levelSystem.getLevelStats();this.ui.getElements().survivalTime.textContent=t.duration.toString(),this.ui.getElements().finalScore.textContent=e.score.toString(),this.ui.getElements().asteroidsDestroyed.textContent=e.asteroidsDestroyed.toString(),this.ui.setGameResult(`Ð£Ð ÐžÐ’Ð•ÐÐ¬ ${t.id} ÐŸÐ ÐžÐ™Ð”Ð•Ð!`,"#00ff88","0 0 20px #00ff88"),this.showNextLevelButton()}showNextLevelButton(){const t=this.ui.getElements().restartButton;t.textContent="Ð¡Ð›Ð•Ð”Ð£Ð®Ð©Ð˜Ð™ Ð£Ð ÐžÐ’Ð•ÐÐ¬";const e=t.onclick;t.onclick=()=>{this.startNextLevel(),t.onclick=e,t.textContent="PLAY AGAIN"},this.ui.showGameOver(!0)}showRestartLevelButton(){this.ui.getElements().restartButton.textContent="ÐŸÐžÐ’Ð¢ÐžÐ Ð˜Ð¢Ð¬ Ð£Ð ÐžÐ’Ð•ÐÐ¬",this.ui.showGameOver(!0)}showGameCompleteScreen(){const t=this.levelSystem.getLevelStats();this.ui.getElements().survivalTime.textContent=this.levelSystem.getCurrentLevel().duration.toString(),this.ui.getElements().finalScore.textContent=t.score.toString(),this.ui.getElements().asteroidsDestroyed.textContent=t.asteroidsDestroyed.toString(),this.ui.setGameResult("Ð’Ð¡Ð¯ Ð˜Ð“Ð Ð ÐŸÐ ÐžÐ™Ð”Ð•ÐÐ!","#ffff00","0 0 20px #ffff00");const e=this.ui.getElements().restartButton;e.textContent="Ð“Ð›ÐÐ’ÐÐžÐ• ÐœÐ•ÐÐ®";const s=e.onclick;e.onclick=()=>{this.returnToMainMenu(),e.onclick=s,e.textContent="PLAY AGAIN"},this.ui.showGameOver(!0)}showLevelFailedScreen(){const t=this.levelSystem.getCurrentLevel(),e=this.levelSystem.getLevelStats();this.ui.getElements().survivalTime.textContent=Math.ceil(this.gameTime).toString(),this.ui.getElements().finalScore.textContent=e.score.toString(),this.ui.getElements().asteroidsDestroyed.textContent=e.asteroidsDestroyed.toString(),this.ui.setGameResult(`Ð£Ð ÐžÐ’Ð•ÐÐ¬ ${t.id} ÐŸÐ ÐžÐ’ÐÐ›Ð•Ð`,"#ff4444","0 0 20px #ff4444"),this.showRestartLevelButton()}startGame(){this.gameRunning&&this.animationId&&cancelAnimationFrame(this.animationId),this.ui.showStart(!1),this.ui.showHud(!0),this.gameRunning=!0,this.levelSystem?this.levelSystem.loadLevel(1):this.levelSystem=new f,this.init(),this.gameLoop()}returnToMainMenu(){this.gameRunning=!1,this.animationId&&cancelAnimationFrame(this.animationId),this.score=0,this.gameTime=60,this.power=0,this.asteroidsDestroyed=0,this.gameWon=!1,this.stars=[],this.powerStars=[],this.asteroids=[],this.particles=[],this.explosions=[],this.player.x=400,this.player.y=300,this.player.armor=3,this.ui.showGameOver(!1),this.ui.showHud(!1),this.ui.showStart(!0)}restartEntireGame(){this.levelSystem.loadLevel(1),this.startLevel(1)}gameOver(){this.gameRunning=!1,this.animationId&&cancelAnimationFrame(this.animationId),this.showLevelFailedScreen()}}window.addEventListener("DOMContentLoaded",()=>{new w});
